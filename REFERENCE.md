# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`gpfs`](#gpfs): NCSA Spectrum Scale Puppet Module (formerly GPFS)    @summary   This module will install the latest version of GPFS for the specified   yum r
* [`gpfs::add_client`](#gpfsadd_client): Add this node to the gpfs cluster
* [`gpfs::bindmounts`](#gpfsbindmounts): Create bindmounts as specified in Hiera
* [`gpfs::cron`](#gpfscron): Install cron jobs for:    - Exempt gpfs from linux kernel OOM killer    - (OPTIONAL) accept license for all nodes in cluster  Parameters:
* [`gpfs::firewall`](#gpfsfirewall)
* [`gpfs::health`](#gpfshealth): Congifure GPFS Health Checks Via Telegraf
* [`gpfs::install`](#gpfsinstall): Manage a gpfs yum repo (optional) & Install GPFS
* [`gpfs::nativemounts`](#gpfsnativemounts): Mount all specified GPFS filesystems
* [`gpfs::quota`](#gpfsquota): Override native gpfs quota command with a script that will
invoke a custom quota command on the gpfs server specified by
$host on $port.
* [`gpfs::startup`](#gpfsstartup): Start GPFS and wait for verification that it started successfully

### Defined types

* [`gpfs::bindmount`](#gpfsbindmount): Defined type, not intended to be invoked directly, but rather via
gpfs::bindmounts. The name of the resource is the target mountpath.
* [`gpfs::nativemount`](#gpfsnativemount): Create mount options file, populated with specified options
Ensure parent (mountpoint) directory exists
Ensure the filesystem is mounted
Name: gpfs filesystem name

## Classes

### <a name="gpfs"></a>`gpfs`

NCSA Spectrum Scale Puppet Module (formerly GPFS)

  @summary
  This module will install the latest version of GPFS for the specified
  yum repository.  GPFS version is thus controlled by yumrepo_baseurl.

  Parameters:

#### Examples

##### 

```puppet
include gpfs
```

#### Parameters

The following parameters are available in the `gpfs` class:

* [`resource_defaults`](#resource_defaults)

##### <a name="resource_defaults"></a>`resource_defaults`

Data type: `Hash[String[1], Hash[String[1], Data, 1], 1]`

OPTIONAL - default values set in module hiera

### <a name="gpfsadd_client"></a>`gpfs::add_client`

Add this node to the gpfs cluster

#### Parameters

The following parameters are available in the `gpfs::add_client` class:

* [`interface`](#interface)
* [`master_server`](#master_server)
* [`mmsdrfs`](#mmsdrfs)
* [`nodeclasses`](#nodeclasses)
* [`pagepool`](#pagepool)
* [`pagepool_max_ram_percent`](#pagepool_max_ram_percent)
* [`script_tgt_fn`](#script_tgt_fn)
* [`ssh_private_key_contents`](#ssh_private_key_contents)
* [`ssh_private_key_path`](#ssh_private_key_path)
* [`ssh_public_key_contents`](#ssh_public_key_contents)
* [`ssh_public_key_type`](#ssh_public_key_type)

##### <a name="interface"></a>`interface`

Data type: `String`

OPTIONAL - Name of network interface whose IP will be used to register with GPFS.
If undefined with add with default (accoring to Puppet) IP address.

##### <a name="master_server"></a>`master_server`

Data type: `String[1]`

FQDN of gpfs master server

##### <a name="mmsdrfs"></a>`mmsdrfs`

Data type: `String[1]`

OPTIONAL - path to mmsdrfs command default set in module hiera

##### <a name="nodeclasses"></a>`nodeclasses`

Data type: `Array`

OPTIONAL - list of nodeclasses to which this node should be added master_server

##### <a name="pagepool"></a>`pagepool`

Data type: `String`

OPTIONAL - Amount of RAM to dedicate to gpfs pagepool.
Format: integer number followed by one of K, M, or G.

##### <a name="pagepool_max_ram_percent"></a>`pagepool_max_ram_percent`

Data type: `Integer`

OPTIONAL - Max percent of RAM allowed for gpfs pagepool.
Must be an integer between 10 and 90.

##### <a name="script_tgt_fn"></a>`script_tgt_fn`

Data type: `String[1]`

OPTIONAL - where to store the "add_client" bash script default set in module hiera

##### <a name="ssh_private_key_contents"></a>`ssh_private_key_contents`

Data type: `String[1]`

private ssh key contents to enable ssh into master_server

##### <a name="ssh_private_key_path"></a>`ssh_private_key_path`

Data type: `String[1]`

OPTIONAL - path to store the gpfs private key (default set in module hiera)

##### <a name="ssh_public_key_contents"></a>`ssh_public_key_contents`

Data type: `String[1]`

public ssh key contents to enable ssh into master_server

##### <a name="ssh_public_key_type"></a>`ssh_public_key_type`

Data type: `String[1]`

public ssh key type, e.g. 'rsa'

### <a name="gpfsbindmounts"></a>`gpfs::bindmounts`

Create bindmounts as specified in Hiera

#### Examples

##### 

```puppet
This class is already included by gpfs::init, so just need to specify,
in hiera, the list of bindmounts and associated data.
```

#### Parameters

The following parameters are available in the `gpfs::bindmounts` class:

* [`mountmap`](#mountmap)

##### <a name="mountmap"></a>`mountmap`

Data type: `Hash`

HIERA
---
gpfs::bindmounts::mountmap:
    /scratch:
        opts: nosuid
        src_path:  /lsst/scratch
        src_mountpoint: /lsst

Default value: `{}`

### <a name="gpfscron"></a>`gpfs::cron`

Install cron jobs for:
   - Exempt gpfs from linux kernel OOM killer
   - (OPTIONAL) accept license for all nodes in cluster

Parameters:

#### Parameters

The following parameters are available in the `gpfs::cron` class:

* [`accept_license`](#accept_license)

##### <a name="accept_license"></a>`accept_license`

Data type: `Boolean`

Install cron script to auto accept license

### <a name="gpfsfirewall"></a>`gpfs::firewall`

The gpfs::firewall class.

#### Parameters

The following parameters are available in the `gpfs::firewall` class:

* [`allow_from`](#allow_from)

##### <a name="allow_from"></a>`allow_from`

Data type: `Array[String[1], 1]`

Allow incoming traffic from these sources on GPFS specific tcp
ports.

### <a name="gpfshealth"></a>`gpfs::health`

Congifure GPFS Health Checks Via Telegraf

#### Examples

##### 

```puppet
include gpfs::health
```

#### Parameters

The following parameters are available in the `gpfs::health` class:

* [`enabled`](#enabled)
* [`file_base_name`](#file_base_name)
* [`telegraf_cfg`](#telegraf_cfg)
* [`telegraf_script_cfg_fs`](#telegraf_script_cfg_fs)
* [`telegraf_script_cfg_paths`](#telegraf_script_cfg_paths)
* [`telegraf_script_cfg_files`](#telegraf_script_cfg_files)
* [`telegraf_script_cfg_filestat`](#telegraf_script_cfg_filestat)

##### <a name="enabled"></a>`enabled`

Data type: `Boolean`

Enable or disable this health check

##### <a name="file_base_name"></a>`file_base_name`

Data type: `String`

Basename of files used by the health check

##### <a name="telegraf_cfg"></a>`telegraf_cfg`

Data type: `Hash`

Hash of key:value pairs passed to telegraf::input as options

##### <a name="telegraf_script_cfg_fs"></a>`telegraf_script_cfg_fs`

Data type: `String`

Optional GPFS filesystems parameter.
This is a space separated list of file system device names according to gpfs.
If empty will lookup from `gpfs::nativemounts::mountmap` paramter.

##### <a name="telegraf_script_cfg_paths"></a>`telegraf_script_cfg_paths`

Data type: `String`

Optional GPFS paths parameter.
This is a space separated list of paths that the ls check should run on.
If empty will lookup from `gpfs::bindmounts::mountmap` paramter.

##### <a name="telegraf_script_cfg_files"></a>`telegraf_script_cfg_files`

Data type: `String`

Optional GPFS files parameter.
This is a space separated list of files the stat check should run on.
If empty will lookup paths from `gpfs::nativemounts::mountmap` paramter and
use files from `telegraf_script_cfg_filestat` paramter.

##### <a name="telegraf_script_cfg_filestat"></a>`telegraf_script_cfg_filestat`

Data type: `String`

Filename (or directory) to stat for file health checks

### <a name="gpfsinstall"></a>`gpfs::install`

Manage a gpfs yum repo (optional) & Install GPFS

#### Parameters

The following parameters are available in the `gpfs::install` class:

* [`yumrepo`](#yumrepo)
* [`pkg_list`](#pkg_list)

##### <a name="yumrepo"></a>`yumrepo`

Data type: `Hash`

Hash of yumrepo parameters in form of yumrepo parameters

##### <a name="pkg_list"></a>`pkg_list`

Data type: `Array[String[1], 1]`

OPTIONAL - List of dependent OS packages to install. Default value defined
in module hiera.

### <a name="gpfsnativemounts"></a>`gpfs::nativemounts`

Mount all specified GPFS filesystems

#### Examples

##### 

```puppet
This class is already included from gpfs::init, so just need to
specify, in hiera, which filesystems to mount
```

#### Parameters

The following parameters are available in the `gpfs::nativemounts` class:

* [`mountmap`](#mountmap)

##### <a name="mountmap"></a>`mountmap`

Data type: `Hash`

HIERA
---
gpfs::nativemounts::mountmap:
    lsst:
        opts: ro

Default value: `{}`

### <a name="gpfsquota"></a>`gpfs::quota`

NCSA custom quota command

#### Parameters

The following parameters are available in the `gpfs::quota` class:

* [`host`](#host)
* [`port`](#port)

##### <a name="host"></a>`host`

Data type: `String[1]`

Host that should be used for custom quota command.

##### <a name="port"></a>`port`

Data type: `Integer[1, 65535]`

Port on the custom quota host.

### <a name="gpfsstartup"></a>`gpfs::startup`

Start GPFS and wait for verification that it started successfully

#### Parameters

The following parameters are available in the `gpfs::startup` class:

* [`cmds`](#cmds)

##### <a name="cmds"></a>`cmds`

Data type: `Hash[String[1], String[1], 2, 2]`

OPTIONAL - default values set in module hiera

## Defined types

### <a name="gpfsbindmount"></a>`gpfs::bindmount`

Create a bindmount

#### Parameters

The following parameters are available in the `gpfs::bindmount` defined type:

* [`src_path`](#src_path)
* [`src_mountpoint`](#src_mountpoint)
* [`opts`](#opts)

##### <a name="src_path"></a>`src_path`

Data type: `String[1]`

The source of this bindmount (ie: the directory this bindmount will point
to).

##### <a name="src_mountpoint"></a>`src_mountpoint`

Data type: `String[1]`

The mountpath of the gpfs filesystem that this bindmount depends
on

##### <a name="opts"></a>`opts`

Data type: `String`

Comma separated list of mount options.

Default value: `''`

### <a name="gpfsnativemount"></a>`gpfs::nativemount`

Represent a native gpfs filesystem mount

#### Examples

##### 

```puppet
gpfs::nativemount { 'software': }

gpfs::nativemount { 'data':
    opts='ro,nosuid',
    mountpoint='/data' }
}
```

#### Parameters

The following parameters are available in the `gpfs::nativemount` defined type:

* [`opts`](#opts)
* [`mountpoint`](#mountpoint)

##### <a name="opts"></a>`opts`

Data type: `Any`

OPTIONAL - Comma separated string of additional mount options.
Defaults to 'noauto'. Note: 'noauto' will always be included in the
options (cannot be overridden).

Default value: `''`

##### <a name="mountpoint"></a>`mountpoint`

Data type: `Any`

OPTIONAL - Where the filesystem is mounted at defaults to '/FSNAME', where
FSNAME is replaced with the gpfs filesystem name. Note: this must match
the mountpoint specified in the gpfs filesystem configuration (ie: mmlsfs).

Default value: `''`

